<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Text Diagram</title>
		<link rel="stylesheet" type="text/css" href="style.css" />

	<script language="javascript">var ie = 0; </script>
	<script language="vbscript">ie = 1</script>
	</head>
	<body>
		<div id='header'>
            <label><strong>Text Diagram</strong></label>
            <a href='https://github.com/weidagang/text-diagram' style='padding-left: 20px'>Source Code</a> 
            <a href='' style='padding-left: 10px' onclick='javascript:example(); return false;'>Example</a> 
            <a href='contact.htm' style='padding-left: 10px'>About Me</a>
        </div>
        
		<textarea id='src' class='code_box' rows="13" cols="80" style='margin-top:10px;'>
object April Todd Monad
note left of April: Lunch is ready
April->Todd: Todd, what are you doing?
note right of Todd: Programming @_@
Todd->April: Well, I'm programming.
April->Monad: And you?
Monad->April: I'm reading book.
April->Monad: Good boy!
note right of Monad: Smile ^_^</textarea>

		<div id='btn_div'>
			<button class='btn white' onclick='javascript:draw();'>Run</button>
		</div>
		
		<div id='msg' style='color:red'></div>
		<div id='canvas'></div>

		<script src='text-diagram.js'></script>
		<script>
			function message(text) {
				var msg = document.getElementById('msg');
				msg.innerHTML = text;			
			}

			function clear_canvas() {
				var canvas = document.getElementById('canvas');

				if (canvas.hasChildNodes() ) {
    				while (canvas.childNodes.length >= 1) {
						canvas.removeChild( canvas.firstChild );       
    				}
				}
			}

			function draw() {
				clear_canvas();
				message('');
				
				var src = document.getElementById('src');
				var dom_ele = sequence_diagram(src.value);
				if (null != dom_ele) {
					var canvas = document.getElementById('canvas');
					canvas.appendChild(dom_ele);					
				}
				else {
					message('Syntax error');
				}
			}
            
            function example() {
                var src = document.getElementById('src');
                src.value =         "object April Todd Monad\n"
                    + "note left of April: Lunch is ready\n"
                    + "April->Todd: Todd, what are you doing?\n"
                    + "note right of Todd: Programming @_@\n"
                    + "Todd->April: Well, I'm programming.\n"
                    + "April->Monad: And you?\n"
                    + "Monad->April: I'm reading book.\n"
                    + "April->Monad: Good boy!\n"
                    + "note right of Monad: Smile ^_^\n"
                ;
                
                draw();
            }

			draw();
		</script>
	</body>
</html>

